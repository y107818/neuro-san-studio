# Copyright Â© 2025 Cognizant Technology Solutions Corp, www.cognizant.com.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
# END COPYRIGHT

{
    "metadata": {
        "description": "Multi-agent system with memory capabilities that can remember new facts and recall them during conversations. Stores memories organized by topics in sly_data with optional file persistence. Demonstrates agent-oriented software for memory storage and retrieval with timestamped entries.",
        "tags": ["memory", "sly_data", "tool", "experimental"],
        "sample_queries": [
            "Bill has a dog named Max",
            "What do you know about Bill?",
            "Remember that Alice lives in San Francisco and works as a software engineer",
        ]
    },
    
    "llm_config": {
        "model_name": "bedrock-us-claude-sonnet-4",
    },
    "max_iterations": 40000,
    "max_execution_seconds": 6000,
    "instructions_prefix": """
    You are a general assistant with the power of memory.
    """,

    "tools": [
        # This first agent definition is regarded as the "Front Man", which
        # does all the talking to the outside world/client.
        #
        # Some disqualifications from being a front man:
        #   1) Cannot use a CodedTool "class" definition
        #   2) Cannot use a Tool "toolbox" definition
        #
        # Besides the first agent being the front man, these tool definitions
        # do not have to be in any particular order. How they are linked and
        # call each other is defined within their own specs.
        # This could be a graph, potentially even with cycles.
        {
            "name": "kwik_agent",
            "function": {
                "description": "I can help you create an agent network."
            },
            "instructions": ${instructions_prefix} """
You will engage in a dialog with the user and use your tools to memorize or recall memories.
Before responding, check the existing list of topics in your memory (if any). You should retrieve this list using your list_topics tool.
Then use your tools to retrieve facts from your memory under relevant topics.
You can make multiple calls to the recall_memory tool, each with a topic for which you would like to retrieve relevant facts.
You can choose to use these recollections in responding to the user.
With every entry from the user, see if there are any facts about the user or the world that you did not know before.
Use your commit_to_memory tool to memorize all such facts. Each fact should be stored under a topic.
These could be topics you've used before, or new ones, expanding the list of topics.
In your response, state all relevant memories you used to formulate the response.
List such facts under a section header named 'Relevant facts from memory:'.
            """,
            "allow": {
                "to_upstream": {
                    "sly_data": {
                        "TopicMemory": true,
                    }
                }
            },
            "tools": ["commit_to_memory", "recall_memory", "list_topics"]
        },
        {
            "name": "commit_to_memory",
            "function": {
                "description": "I can commit facts to memory."
                "parameters": {
                    "type": "object",
                    "properties": {
                        "new_fact": {
                            "type": "string",
                            "description": "a brief description of the new fact to remember."
                        },
                        "topic": {
                            "type": "string",
                            "description": "a topic for this new fact to be stored under."
                        },
                    },
                    "required": ["new_fact", "topic"]
                }
            },
            "class": "commit_to_memory.CommitToMemory"
        },
        {
            "name": "recall_memory",
            "function": {
                "description": "I can recall relevant facts from memory."
                "parameters": {
                    "type": "object",
                    "properties": {
                        "topic": {
                            "type": "string",
                            "description": "A topic for which to retrieve relevant facts."
                        },
                    },
                    "required": ["topic"]
                }
            },
            "class": "recall_memory.RecallMemory"
        },
        {
            "name": "list_topics",
            "function": {
                "description": "Lists all topics that have been stored in memory."
            },
            "class": "list_topics.ListTopics"
        },
    ]
}
